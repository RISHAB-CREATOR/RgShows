"use strict";(()=>{const t=function(){const t=new Map,e=[["bumpers","","propsToMatch","url:/playback2.a2d.tv\\/play/"]],n=new Map([["mtv.fi",0],["mtvuutiset.fi",0]]),r=new Map([]),o=new Map([]);function s(...t){!function(t="",e=""){const n=a(),r=n.getExtraArgs(Array.from(arguments),2),o=l({log:""===t||r.log}),s=o?(...t)=>{n.uboLog(...t)}:()=>{},f=function(t,e=""){const n=a(),r=new Map;if(void 0===t||""===t)return r;const o={canNegate:!0};for(const s of t.split(/\s+/)){const[t,c]=s.split(":");""!==t&&(void 0!==c?r.set(t,n.initPattern(c,o)):""!==e&&r.set(e,n.initPattern(t,o)))}return r}(r.propsToMatch,"url"),u=n.initPattern(r.stackToMatch||"",{canNegate:!0}),p=function(a,l,p){const h=Reflect.apply(a,l,p);if(!0===o&&s("json-prune-fetch-response:",JSON.stringify(Array.from(p)).slice(1,-1)),""===t)return h;let g="match";if(0!==f.size){const t=[p[0]instanceof Object?p[0]:{url:p[0]}];if(t[0]instanceof Request)try{t[0]=n.Request_clone.call(t[0])}catch(t){s(t)}p[1]instanceof Object&&t.push(p[1]),!1===c(f,...t)&&(g="nomatch"),g!==o&&"all"!==o||s(`json-prune-fetch-response (${g})`,`\n\tfetchPropsToMatch: ${JSON.stringify(Array.from(f)).slice(1,-1)}`,"\n\tprops:",...t)}return"nomatch"===g?h:h.then((n=>n.clone().json().then((o=>{if("object"!=typeof o)return n;const s=i(o,t,e,u,r);if("object"!=typeof s)return n;const c=Response.json(s,{status:n.status,statusText:n.statusText,headers:n.headers});return Object.defineProperties(c,{ok:{value:n.ok},redirected:{value:n.redirected},type:{value:n.type},url:{value:n.url}}),c})).catch((t=>(s("json-prune-fetch-response:",t),n))))).catch((t=>(s("json-prune-fetch-response:",t),h)))};self.fetch=new Proxy(self.fetch,{apply:p})}(...t)}function c(t,...e){void 0===c.extractProperties&&(c.extractProperties=(t,e,n)=>{for(const r of n){void 0!==t[r]&&(e[r]=t[r])}});const n=a(),r={},o=n.Array_from(t.keys());for(const t of e)t instanceof Object!=!1&&c.extractProperties(t,r,o);for(const[e,o]of t){let t=r[e];if(void 0!==t){if("string"!=typeof t){try{t=JSON.stringify(t)}catch(t){}if("string"!=typeof t)continue}if(!n.testPattern(o,t))return!1}}return!0}function i(t,e,n,r={matchAll:!0},o={}){if("string"!=typeof e)return;const s=a(),c=""!==e?e.split(/ +/):[],u=0!==c.length&&""!==n?n.split(/ +/):[],p=l({log:""===e||o.log}),h=s.patternToRegex(!0===p?n:"");if(!0!==r.matchAll&&!1===function(t,e=""){const n=a(),r=function(){const t=a(),e=String.fromCharCode(Date.now()%26+97)+t.Math_floor(982451653*t.Math_random()+982451653).toString(36),n=self.onerror;return self.onerror=function(t,...r){return!("string"!=typeof t||!t.includes(e))||(n instanceof Function?n.call(this,t,...r):void 0)}.bind(),e}(),o=new n.Error(r),s=new URL(self.location.href);s.hash="";const c=/(.*?@)?(\S+)(:\d+):\d+\)?$/,i=[];for(let t of o.stack.split(/[\n\r]+/)){if(t.includes(r))continue;t=t.trim();const e=n.RegExp_exec.call(c,t);if(null===e)continue;let o=e[2];o.startsWith("(")&&(o=o.slice(1)),o===s.href?o="inlineScript":o.startsWith("<anonymous>")&&(o="injectedScript");let a=void 0!==e[1]?e[1].slice(0,-1):t.slice(0,e.index).trim();a.startsWith("at")&&(a=a.slice(2).trim());let l=e[3];i.push(" "+`${a} ${o}${l}:1`.trim())}i[0]="stackDepth:"+(i.length-1);const l=i.join("\t"),f=!0!==t.matchAll&&n.testPattern(t,l);("all"===e||"match"===e&&f||"nomatch"===e&&!f)&&n.uboLog(l.replace(/\t/g,"\n"));return f}(r,o.logstack))return;void 0===i.mustProcess&&(i.mustProcess=(t,e)=>{for(const n of e)if(!1===f(t,n))return!1;return!0},i.logJson=(t,e,n)=>{!1!==n.test(t)&&a().uboLog("objectPrune()",e,location.hostname,t)});const g=p?s.JSON_stringify(t,null,2):"";if(!0!==p&&"all"!==p||i.logJson(g,`prune:"${e}" log:"${p}"`,h),0===c.length)return;let d="nomatch";if(i.mustProcess(t,u))for(const e of c)f(t,e,!0)&&(d="match");return p===d&&i.logJson(g,`prune:"${e}" log:"${p}"`,h),"match"===d?t:void 0}function a(){if(t.has("safeSelf"))return t.get("safeSelf");const e=globalThis,n={Array_from:Array.from,Error:e.Error,Function_toStringFn:e.Function.prototype.toString,Function_toString:t=>n.Function_toStringFn.call(t),Math_floor:Math.floor,Math_max:Math.max,Math_min:Math.min,Math_random:Math.random,Object,Object_defineProperty:Object.defineProperty.bind(Object),Object_fromEntries:Object.fromEntries.bind(Object),Object_getOwnPropertyDescriptor:Object.getOwnPropertyDescriptor.bind(Object),RegExp:e.RegExp,RegExp_test:e.RegExp.prototype.test,RegExp_exec:e.RegExp.prototype.exec,Request_clone:e.Request.prototype.clone,XMLHttpRequest:e.XMLHttpRequest,addEventListener:e.EventTarget.prototype.addEventListener,removeEventListener:e.EventTarget.prototype.removeEventListener,fetch:e.fetch,JSON:e.JSON,JSON_parseFn:e.JSON.parse,JSON_stringifyFn:e.JSON.stringify,JSON_parse:(...t)=>n.JSON_parseFn.call(n.JSON,...t),JSON_stringify:(...t)=>n.JSON_stringifyFn.call(n.JSON,...t),log:console.log.bind(console),uboLog(...e){!1!==t.has("canDebug")&&0!==e.length&&""!=`${e[0]}`&&this.log("[uBO]",...e)},escapeRegexChars:t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),initPattern(t,e={}){if(""===t)return{matchAll:!0};const n=!0!==e.canNegate||!1===t.startsWith("!");!1===n&&(t=t.slice(1));const r=/^\/(.+)\/([gimsu]*)$/.exec(t);return null!==r?{re:new this.RegExp(r[1],r[2]||e.flags),expect:n}:void 0!==e.flags?{re:new this.RegExp(this.escapeRegexChars(t),e.flags),expect:n}:{pattern:t,expect:n}},testPattern(t,e){return!!t.matchAll||(t.re?this.RegExp_test.call(t.re,e)===t.expect:e.includes(t.pattern)===t.expect)},patternToRegex(t,e=void 0,n=!1){if(""===t)return/^/;const r=/^\/(.+)\/([gimsu]*)$/.exec(t);if(null===r){const r=this.escapeRegexChars(t);return new RegExp(n?`^${r}$`:r,e)}try{return new RegExp(r[1],r[2]||void 0)}catch(t){}return/^/},getExtraArgs(t,e=0){const n=t.slice(e).reduce(((t,e,n,r)=>{if(0==(1&n)){const e=r[n+1],o=/^\d+$/.test(e)?parseInt(e,10):e;t.push([r[n],o])}return t}),[]);return this.Object_fromEntries(n)}};return t.set("safeSelf",n),n}function l(e){return e instanceof Object!=!1&&(t.has("canDebug")&&e.log)}function f(t,e,n=!1){let r=t,o=e;for(;;){if("object"!=typeof r||null===r)return!1;const t=o.indexOf(".");if(-1===t){if(!1===n)return r.hasOwnProperty(o);let t=!1;if("*"===o)for(const e in r)!1!==r.hasOwnProperty(e)&&(delete r[e],t=!0);else r.hasOwnProperty(o)&&(delete r[o],t=!0);return t}const e=o.slice(0,t);if("[]"===e&&Array.isArray(r)||"*"===e&&r instanceof Object){const e=o.slice(t+1);let s=!1;for(const t of Object.keys(r))s=f(r[t],e,n)||s;return s}if(!1===r.hasOwnProperty(e))return!1;r=r[e],o=o.slice(t+1)}return!0}const u=[];try{u.push(...document.location.hostname.split("."))}catch(t){}const p=u.length;if(0===p)return;const h=new Set,g=[];if(0!==o.size){for(let t=0;t<p;t++){const e=u.slice(t).join("."),n=o.get(e);n&&g.push(...n)}o.clear()}if(0!==n.size){const t=t=>{let e=n.get(t);if(void 0!==e){"number"==typeof e&&(e=[e]);for(const t of e)g.includes(t)||h.add(t)}};for(let e=0;e<p;e++){t(u.slice(e).join("."))}t("*"),n.clear()}if(0!==r.size){const t=p-1;for(let e=0;e<t;e++)for(let n=t;n>e;n--){const t=u.slice(e,n).join(".");let o=r.get(t);if(void 0!==o){"number"==typeof o&&(o=[o]);for(const t of o)g.includes(t)||h.add(t)}}r.clear()}for(const t of h)try{s(...e[t])}catch(t){}e.length=0};if("object"!=typeof wrappedJSObject)return t();{const e=self.wrappedJSObject;let n,r;try{e.uBOL_jsonPruneFetchResponse=cloneInto([["(",t.toString(),")();"],{type:"text/javascript; charset=utf-8"}],self);const o=new e.Blob(...e.uBOL_jsonPruneFetchResponse);r=e.URL.createObjectURL(o);const s=e.document;n=s.createElement("script"),n.async=!1,n.src=r,(s.head||s.documentElement||s).append(n)}catch(t){console.error(t)}r&&(n&&n.remove(),e.URL.revokeObjectURL(r)),delete e.uBOL_jsonPruneFetchResponse}})();