"use strict";!function(){const e=self.genericSelectorMap||new Map;if(delete self.genericSelectorMap,0===e.size)return;const t=[];let o,s,n,d=0,i=0,r=Date.now();const c=(e,t)=>{const o=t.length,s=o+7>>>3;let n=(e<<5)+e^o;for(let e=0;e<o;e+=s)n=(n<<5)+n^t.charCodeAt(e);return 16777215&n},l=(e,t)=>{const o=e.id;"string"==typeof o&&0!==o.length&&t.push(c(35,o.trim()))},a=(e,t)=>{const o=e.getAttribute("class");if("string"!=typeof o)return;const s=o.length;for(let e=0,n=0;e<s;e+=1)n=o.indexOf(" ",e),n!==e&&(-1===n&&(n=s),t.push(c(46,o.slice(e,n))),e=n)},f={addedNodes:[],nodeSet:new Set,add(e){this.addedNodes.push(e)},next(e){for(const e of this.addedNodes)if(!this.nodeSet.has(e)&&(1===e.nodeType&&this.nodeSet.add(e),null!==e.firstElementChild))for(const t of e.querySelectorAll("[id],[class]"))this.nodeSet.add(t);this.addedNodes.length=0;for(const t of this.nodeSet)if(this.nodeSet.delete(t),e.push(t),64===e.length)break},hasNodes(){return 0!==this.addedNodes.length||0!==this.nodeSet.size}},h=()=>{const s=[],n=[],r=Date.now()+4;for(;f.next(n),0!==n.length;){for(const e of n)l(e,s),a(e,s);if(n.length=0,performance.now()>=r)break}for(const o of s){const s=e.get(o);void 0!==s&&(t.push(s),e.delete(o))}if(d+=1,0===t.length)return i+=1,void(d>=100&&i/d>=.95&&p(`too many misses in surveyor (${i}/${d})`));void 0===o&&(o=self.requestAnimationFrame((()=>{o=void 0,u(`${t.join(",")}{display:none!important;}`),t.length=0})))},u=(e,t=10)=>{chrome.runtime.sendMessage({what:"insertCSS",css:e}).catch((()=>{0!==(t-=1)&&u(e,t-1)}))};f.add(document),h();let g=new MutationObserver((e=>{for(let t=0;t<e.length;t++){const o=e[t];for(const e of o.addedNodes)1===e.nodeType&&f.add(e)}!1!==f.hasNodes()&&(r=Date.now(),void 0===s&&(s=self.setTimeout((()=>{s=void 0,h()}),64)))}));g.observe(document,{childList:!0,subtree:!0});const m=()=>{if(n=void 0,void 0!==g)return Date.now()-r>2e4?p("no more DOM changes"):void(n=self.setTimeout(m,2e4))};m();const p=t=>{void 0!==n&&(self.clearTimeout(n),n=void 0),g.disconnect(),g.takeRecords(),g=void 0,e.clear(),console.info(`uBOL: Generic cosmetic filtering stopped because ${t}`)}}();